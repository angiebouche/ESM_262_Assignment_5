---
title: "Assignment 5 RMD"
author: "Angie Bouche"
date: "June 7, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

```{r}
library(tidyverse)
library(testthat)
library(dplyr)
library(devtools)

ghg <- read_csv("GHG.csv")
```

## Summarize: Average natural gas emissions by year
```{r}
ng_emissions = ghg %>% 
  filter(Fuel_Type == "Natural Gas") %>% 
  select(Total_CO2_Emissions) %>% 
  summarize(mean = (sum(Total_CO2_Emissions)/7))

```


##Summarize: Add up total emisisons by year
```{r}
annual_emissions = ghg %>% 
  group_by(Year) %>% 
  summarize(sum_col = sum(Total_CO2_Emissions)) %>%  
  arrange(-Year) %>% 
  head(10)

```

## Array:
```{r}

emissions_year = array(1:40, dim=c(5,4,2), #fill array with numbers 1-40 FAKE DATA
                dimnames = list(c('Transportation', 'Electricity_Generation', 'Residential', 'Commercial',  'Industrial'),
              c('Diesel', 'Gasoline', 'Coal', 'Natural Gas'),
              c(2010,2016))) # add column names
              emissions_year 

#each ton is taxed $1,000 - econ cost for emissions for each sector 
calculate_cost = apply(emissions_year, c(1), sum)*100

```



##Possible Tests
```{r}
usethis::use_test()


test_that("Data from 2019 is not included", {
  expect_false(add_total_emissions_year(Year="2019"))
})

source("R/average_ng.R")
test_that("Average natural gas emissions are numerical", {
  data(ghg)
  expect_is(average_ng(ghg_ng = ghg), "numeric")
})


test_that("Test that the average natural gas emissions in 2016 were 165.85", {
expect_true(annual_emissions(Year = "2016", sum_col = "165.85"))
})

```
##Vinette
```{r}

# use_vignette("overview")
# build_vignettes()
```


