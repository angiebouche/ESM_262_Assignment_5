---
title: "Assignment 5 RMD"
author: "Angie Bouche"
date: "June 7, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

```{r}
library(tidyverse)
library(testthat)
library(dplyr)
library(devtools)

ghg <- read_csv("GHG.csv")
```

## Summarize: Average natural gas emissions by year
```{r}
ng_emissions = data %>% 
  filter(Fuel_Type == "Natural Gas") %>% 
  select(Total_CO2_Emissions) %>% 
  summarize(mean = (sum(Total_CO2_Emissions)/7))

```


##Summarize: Add up total emisisons by year
```{r}
annual_emissions = data %>% 
  group_by(Year) %>% 
  summarize(sum_col = sum(Total_CO2_Emissions)) %>%  
  arrange(-Year) %>% 
  head(10)

```

## Array:
```{r}

data_for_array <- filter(data, Fuel_Type =="Coal"|"Diesel Fuel (Distillate)"|"Gasoline"|"Natural Gas") 
  gather(data, key ="Fuel_Type", value = "Emissions", Transportation, Electricity_Generation, Residential, Commercial, Industrial, -Total_CO2_Emissions, -Percent_Total_CO2_Emissions, na.rm = TRUE) 

emisisons_year = array(data = data_for_array, 
dim=c(5,4,2),
dimnames = list(c('Transportation', 'Electricity_Generation', 'Residential', 'Commercial', 'Industrial'),
                paste('Fuel_Type'),
                c(2010,2016)))
emisisons_year #look at what casey posts

# add useful names

dimnames(emissions_year) = list(c("Transportation", "Electricity Generation", "Residential", "Commercial",                               "Industrial"), 
                      c("Coal", "Diesel", "Gasoline", "Natural Gas"),
                      c("2010", "2016"))


#  use your own function to calculte impact - maybe set a limit and see what secotra are above? If you are "TRUE" you get a fine - add up the total fines for 2010 and 2016?
co2fine = function(type, thresh) {
  n = length(type)
  fine=100000
  for (i in 1:n) {
    if (type[i] > thresh) fine=0
  }
  return(fine)
}
emisisons_year
#exceeds
apply(emisisons_year, c(1,2), co2fine, thresh=50)

#tells you if the sector will get a 100000 fine, therefore quantifying impacts


#each ton is $1,000 cost - econ cost for emissions
emissions_cost = emisisons_year*1000
emissions_cost

```



##Possible Tests
```{r}
usethis::use_test()


test_that("Data from 2019 is not included", {
  expect_false(add_total_emissions_year(Year="2019"))
})

source("R/average_ng.R")
test_that("Average natural gas emissions are numerical", {
  data(ghg)
  expect_is(average_ng(data_ng = ghg), "numeric")
})


test_that("Test that the average natural gas emissions in 2016 were 165.85", {
expect_true(annual_emissions(Year = "2016", sum_col = "165.85"))
})

```
##Vinette
```{r}

# use_vignette("overview")
build_vignettes()
```


